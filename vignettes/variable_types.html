<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Allison C Fialkowski" />

<meta name="date" content="2017-11-09" />

<title>Variable Types</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Variable Types</h1>
<h4 class="author"><em>Allison C Fialkowski</em></h4>
<h4 class="date"><em>2017-11-09</em></h4>



<p>All variables are generated via an appropriate transformation of standard normal variables, as described below.</p>
<p><strong>1) Continuous Variables:</strong> Continuous variables are simulated using either <span class="citation">Fleishman (1978)</span>’s third-order (<code>method</code> = “Fleishman”) or <span class="citation">Headrick (2002)</span>’s fifth-order (<code>method</code> = “Polynomial”) power method transformation. This is a computationally efficient algorithm that simulates continuous distributions through the method of moments. It works by matching standardized cumulants – the first four (mean, variance, skew, and standardized kurtosis) for Fleishman’s third-order method, or the first six (mean, variance, skew, standardized kurtosis, and standardized fifth and sixth cumulants) for Headrick’s fifth-order method. The transformation is expressed as follows: <span class="math display">\[\Large Y = c_{0} + c_{1} * Z + c_{2} * Z^2 + c_{3} * Z^3 + c_{4} * Z^4 + c_{5} * Z^5,\ Z \sim iid\ N(0,1),\]</span> where <span class="math inline">\(\Large c_{4}\)</span> and <span class="math inline">\(\Large c_{5}\)</span> both equal <span class="math inline">\(\Large 0\)</span> for Fleishman’s method. The real constants are calculated by <code>find_constants</code>, which solves the system of equations given in <code>fleish</code> or <code>poly</code>. All variables are simulated with mean <span class="math inline">\(\Large 0\)</span> and variance <span class="math inline">\(\Large 1\)</span>, and then transformed to the specified mean and variance at the end.</p>
<ol style="list-style-type: lower-alpha">
<li><p>The <strong>required parameters</strong> for simulating continuous variables include: mean, variance, skewness, standardized kurtosis (kurtosis - 3), and standardized fifth and sixth cumulants (for the fifth-order method). If the goal is to simulate a theoretical distribution (i.e. Gamma, Beta, Logistic, etc.), these values can be obtained using <code>calc_theory</code>. If the goal is to mimic an empirical data set, these values can be found using <code>calc_moments</code> (using the method of moments) or <code>calc_fisherk</code> (using Fisher’s k-statistics). If the standardized cumulants are obtained from <code>calc_theory</code>, the user may need to use rounded values as inputs (i.e. <code>skews = round(skews, 8)</code>). Due to the nature of the integration involved in <code>calc_theory</code>, the results are approximations. Greater accuracy can be achieved by increasing the number of subdivisions (<code>sub</code>) used in the integration process. For example, in order to ensure that skew is exactly 0 for symmetric distributions.</p></li>
<li><p>For some sets of cumulants, it is either not possible to find power method constants or the calculated constants do not generate valid power method pdfs. In these situations, adding a value to the sixth cumulant may provide solutions (see <code>find_constants</code>). When using Headrick’s fifth-order approximation, if simulation results indicate that a continuous variable does not generate a valid pdf, the user can try <code>find_constants</code> with various sixth cumulant correction vectors to determine if a valid pdf can be found.</p></li>
<li><p><strong>Choice of Fleishman’s or Headrick’s Method:</strong> Using the fifth-order approximation allows additional control over the fifth and sixth moments of the generated distribution, improving accuracy. In addition, the range of feasible standardized kurtosis values, given skew and standardized fifth (<span class="math inline">\(\Large \gamma_{3}\)</span>) and sixth (<span class="math inline">\(\Large \gamma_{4}\)</span>) cumulants, is larger than with Fleishman’s method. For example, the Fleishman method can not be used to generate a non-normal distribution with a ratio of <span class="math inline">\(\Large \gamma_{3}^2/\gamma_{4} &gt; 9/14\)</span> (see <span class="citation">Headrick and Kowalchuk (2007)</span>). This eliminates the Chi-squared family of distributions, which has a constant ratio of <span class="math inline">\(\Large \gamma_{3}^2/\gamma_{4} = 2/3\)</span>. However, if the fifth and sixth cumulants do not exist, the Fleishman approximation should be used.</p></li>
<li><p><code>SimMultiCorrData::Headrick.dist</code> is Headrick’s Table 1 (2002, p. 691-2). This data.frame contains selected symmetrical and asymmetrical theoretical densities with their associated values of skewness (<span class="math inline">\(\Large \gamma_{1}\)</span>), standardized kurtosis (<span class="math inline">\(\Large \gamma_{2}\)</span>), and standardized fifth (<span class="math inline">\(\Large \gamma_{3}\)</span>) and sixth (<span class="math inline">\(\Large \gamma_{4}\)</span>) cumulants. Constants were calculated by Headrick using his fifth-order polynomial transformation. <code>SimMultiCorrData::H_params</code> provides the parameter inputs needed to calculate the standardized cumulants for the distributions in <code>SimMultiCorrData::Headrick.dist</code> using the function <code>calc_theory</code>.</p></li>
</ol>
<p><strong>2) Ordinal Variables:</strong> Ordinal variables (<span class="math inline">\(\Large r \ge 2\)</span> categories) are generated by discretizing the standard normal variables at quantiles. These quantiles are determined by evaluating the inverse standard normal cdf at the cumulative probabilities defined by each variable’s marginal distribution, as follows: Suppose the goal is to simulate <span class="math inline">\(\Large m\)</span> ordinal random variables for sample size <span class="math inline">\(\Large n\)</span>. For <span class="math inline">\(\Large 1 \leq i \leq m\)</span>, let <span class="math inline">\(\Large {P}_{i}(y)\)</span> be the probability mass function and <span class="math inline">\(\Large {F}_{i}(y)\)</span> the cumulative distribution function of variable <span class="math inline">\(\Large {Y}_{i}\)</span>, with support <span class="math inline">\(\Large {\mathbb{Y}}_{i} = \{{y}_{i(1)},\ {y}_{i(2)},\ ...,\ {y}_{i(r_{i})}\}\)</span>. Here, <span class="math inline">\(\Large r_{i}\)</span> is the number of categories for variable <span class="math inline">\(\Large {Y}_{i}\)</span>. Note that these are the <em>ordered</em> possible values for <span class="math inline">\(\Large {Y}_{i}\)</span> with associated probabilities: <span class="math display">\[\Large {\mathbb{P}}_{i} = \{{P}_{i}({y}_{i(1)}),\ {P}_{i}({y}_{i(2)}),\ ...,\ {P}_{i}({y}_{i(r_{i})})\},\]</span> where <span class="math inline">\(\Large {P}_{i}({y}_{i(r_{i})}) = 1-\sum_{h=1}^{r_{i}-1}{P}_{i}({y}_{i(h)})\)</span>, and cumulative probabilities: <span class="math display">\[\Large {\mathbb{F}}_{i} = \{{F}_{i}({y}_{i(l)}) = \sum_{j=1}^{l}{P}_{i}({y}_{i(j)}),\ l = 1,\ ...,\ r_{i}-1\}.\]</span> The final cumulative probability is obviously one. The corresponding standard normal quantiles for these are given by: <span class="math display">\[\Large {\mathbb{q}}_{i} = \{{q}_{i(l)} = {\Phi}^{-1}({F}_{i}({y}_{i(l)})) = {\Phi}^{-1}(\sum_{j=1}^{l}{P}_{i}({y}_{i(j)})),\ l = 1,\ ...,\ r_{i}-1\}.\]</span> If the support for variable <span class="math inline">\(\Large {Y}_{i}\)</span> is not provided, the default is to use <span class="math inline">\(\Large \{1,\ 2,\ ...,\ r_{i}\}\)</span>. The <span class="math inline">\(\Large m\)</span> random normal variates <span class="math inline">\(\Large {Z}_{1},\ {Z}_{2},\ ...,\ {Z}_{m}\)</span> are discretized using the cumulative probabilities and corresponding normal quantiles found above: <span class="math display">\[\Large if\ {Z}_{i} &lt; {q}_{i(1)} \rightarrow {Y}_{i} = {y}_{i(1)},\]</span> <span class="math display">\[\Large if\ {q}_{i(1)} \leq {Z}_{i} &lt; {q}_{i(2)} \rightarrow {Y}_{i} = {y}_{i(2)},\ ...,\ \]</span> <span class="math display">\[\Large if\ {q}_{i(r_{i})} \leq {Z}_{i} \rightarrow {Y}_{i} = {y}_{i(r_{i})}.\]</span></p>
<p><strong>Required parameters:</strong> For ordinal variables, these are the cumulative marginal probabilities and support values (if desired). The probabilities should be combined into a list of length equal to the number of ordinal variables. The <span class="math inline">\(\Large i^{th}\)</span> element is a vector of the cumulative probabilities defining the marginal distribution of the <span class="math inline">\(\Large i^{th}\)</span> variable. If the variable can take <span class="math inline">\(\Large r\)</span> values, the vector will contain <span class="math inline">\(\Large r - 1\)</span> probabilities (the <span class="math inline">\(\Large r^{th}\)</span> is assumed to be <span class="math inline">\(\Large 1\)</span>). <strong>Note</strong> that for <strong>binary variables</strong>, the user-supplied probability should be the probability of the <span class="math inline">\(\Large 1^{st}\)</span> (lower) support value. This would ordinarily be considered the probability of <em>failure</em> (<span class="math inline">\(\Large q\)</span>), while the probability of the <span class="math inline">\(\Large 2^{nd}\)</span> (upper) support value would be considered the probability of <em>success</em> (<span class="math inline">\(\Large p = 1 - q\)</span>). The support values should be combined into a separate list. The <span class="math inline">\(\Large i^{th}\)</span> element is a vector containing the <span class="math inline">\(\Large r\)</span> ordered support values.</p>
<p><strong>3) Poisson and Negative Binomial Variables:</strong> Count variables are generated using the inverse cdf method. The cumulative distribution function of a standard normal variable has a uniform distribution. The appropriate quantile function <span class="math inline">\(\Large F_{Y}^{-1}\)</span> is applied to this uniform variable with the designated parameters to generate the count variable: <span class="math inline">\(\Large Y = F_{y}^{-1}(\Phi(Z))\)</span>.</p>
<p><strong>Required parameters:</strong> For Poisson variables, the lambda (mean) value should be given (see <code>stats::qpois</code>). For Negative Binomial variables, the size (target number of successes) and either the success probability or the mean should be given (see see <code>stats::qnbinom</code>). The Negative Binomial variable represents the number of failures which occur in a sequence of Bernoulli trials before the target number of successes is achieved. For <strong>Correlation Method 2</strong>, a vector of total cumulative probability truncation values should be provided (one for Poisson and one for Negative Binomial). These values represent the amount of probability removed from the range of the cdf’s <span class="math inline">\(\Large F_{Y}\)</span> when creating finite supports. The value may vary by variable, but a good default value is <span class="math inline">\(\Large 0.0001\)</span> (suggested by <span class="citation">Barbiero and Ferrari (2015)</span>).</p>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-FerrBarb_Pois">
<p>Barbiero, A, and P A Ferrari. 2015. “Simulation of Correlated Poisson Variables.” <em>Applied Stochastic Models in Business and Industry</em> 31: 669–80. doi:<a href="https://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>.</p>
</div>
<div id="ref-Fleish">
<p>Fleishman, A I. 1978. “A Method for Simulating Non-Normal Distributions.” <em>Psychometrika</em> 43: 521–32. doi:<a href="https://doi.org/10.1007/BF02293811">10.1007/BF02293811</a>.</p>
</div>
<div id="ref-Head2002">
<p>Headrick, T C. 2002. “Fast Fifth-Order Polynomial Transforms for Generating Univariate and Multivariate Non-Normal Distributions.” <em>Computational Statistics and Data Analysis</em> 40 (4): 685–711. doi:<a href="https://doi.org/10.1016/S0167-9473(02)00072-5">10.1016/S0167-9473(02)00072-5</a>.</p>
</div>
<div id="ref-HeadKow">
<p>Headrick, T C, and R K Kowalchuk. 2007. “The Power Method Transformation: Its Probability Density Function, Distribution Function, and Its Further Use for Fitting Data.” <em>Journal of Statistical Computation and Simulation</em> 77: 229–49. doi:<a href="https://doi.org/10.1080/10629360600605065">10.1080/10629360600605065</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
